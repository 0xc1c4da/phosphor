var K=Object.defineProperty,Q=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var I=(e,o,n)=>o in e?K(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,E=(e,o)=>{for(var n in o||(o={}))$.call(o,n)&&I(e,n,o[n]);if(P)for(var n of P(o))D.call(o,n)&&I(e,n,o[n]);return e},F=(e,o)=>Q(e,Z(o));var Y={preferredElementNodeName:"PRE",render:ee},U=[],L,R;function ee(e,o){let n=e.settings.element;for((e.rows!=R||e.cols!=L)&&(L=e.cols,R=e.rows,U.length=0);n.childElementCount<R;){let t=document.createElement("span");t.style.display="block",n.appendChild(t)}for(;n.childElementCount>R;)n.removeChild(n.lastChild);let a=0;for(let t=0;t<R;t++){let d=t*L,w=!1;for(let p=0;p<L;p++){let f=p+d,C=o[f],v=U[f];te(C,v)||(w==!1&&a++,w=!0,U[f]=E({},C))}if(w==!1)continue;let l="",u={},s=!1;for(let p=0;p<L;p++){let f=o[p+d];if(f.beginHTML&&(s&&(l+="</span>",u={},s=!1),l+=f.beginHTML),!oe(f,u)){s&&(l+="</span>");let C=f.color===e.settings.color?null:f.color,v=f.backgroundColor===e.settings.backgroundColor?null:f.backgroundColor,r=f.fontWeight===e.settings.fontWeight?null:f.fontWeight,i="";C&&(i+="color:"+C+";"),v&&(i+="background:"+v+";"),r&&(i+="font-weight:"+r+";"),i&&(i=' style="'+i+'"'),l+="<span"+i+">",s=!0}l+=f.char,u=f,f.endHTML&&(s&&(l+="</span>",u={},s=!1),l+=f.endHTML)}s&&(l+="</span>"),n.childNodes[t].innerHTML=l}}function te(e,o){return!(typeof e!="object"||typeof o!="object"||e.char!==o.char||e.fontWeight!==o.fontWeight||e.color!==o.color||e.backgroundColor!==o.backgroundColor)}function oe(e,o){return!(e.fontWeight!==o.fontWeight||e.color!==o.color||e.backgroundColor!==o.backgroundColor)}var q={preferredElementNodeName:"CANVAS",render:ne};function ne(e,o){let n=e.settings.element,a=devicePixelRatio,t=e.cols,d=e.rows,w=e.metrics,l=w.cellWidth,u=Math.round(w.lineHeight),s=e.settings;s.canvasSize?(n.width=s.canvasSize.width*a,n.height=s.canvasSize.height*a,n.style.width=s.canvasSize.width+"px",n.style.height=s.canvasSize.height+"px"):(n.width=e.width*a,n.height=e.height*a);let p=" "+w.fontSize+"px "+w.fontFamily,f=s&&s.backgroundColor?s.backgroundColor:"white",C=s&&s.color?s.color:"black",v=s&&s.fontWeight?s.color:"400",r=n.getContext("2d");if(r.fillStyle=f,r.fillRect(0,0,n.width,n.height),r.save(),r.scale(a,a),r.fillStyle=C,r.textBaseline="top",s.canvasOffset){let i=s.canvasOffset,x=Math.round(i.x=="auto"?(n.width/a-t*l)/2:i.x),g=Math.round(i.y=="auto"?(n.height/a-d*u)/2:i.y);r.translate(x,g)}if(s.textAlign=="center")for(let i=0;i<d;i++){let x=i*t,g=[],z=[],k=[],A=0;for(let S=0;S<t;S++){let c=o[x+S];r.font=(c.fontWeight||v)+p;let y=r.measureText(c.char).width;A+=y,g[S]=y}let M=(n.width/a-A)*.5,W=i*u;for(let S=0;S<t;S++){let c=o[x+S],y=M;c.backgroundColor&&c.backgroundColor!=f&&(r.fillStyle=c.backgroundColor||f,r.fillRect(Math.round(y),W,Math.ceil(g[S]),u)),r.font=(c.fontWeight||v)+p,r.fillStyle=c.color||C,r.fillText(c.char,M,W),M+=g[S]}}else for(let i=0;i<d;i++)for(let x=0;x<t;x++){let g=o[i*t+x],z=x*l,k=i*u;g.backgroundColor&&g.backgroundColor!=f&&(r.fillStyle=g.backgroundColor||f,r.fillRect(Math.round(z),k,Math.ceil(l),u)),r.font=(g.fontWeight||v)+p,r.fillStyle=g.color||C,r.fillText(g.char,z,k)}r.restore()}var T=class{constructor(){this.frames=0,this.ptime=0,this.fps=0}update(o){return this.frames++,o>=this.ptime+1e3&&(this.fps=this.frames*1e3/(o-this.ptime),this.ptime=o,this.frames=0),this.fps}};var V={store:function(e,o){try{return localStorage.setItem(e,JSON.stringify(o)),!0}catch(n){return!1}},restore:function(e,o={}){let n=JSON.parse(localStorage.getItem(e));return Object.assign(o,n),o},clear:function(e){localStorage.removeItem(e)}};var se="1.1";var j={canvas:q,text:Y},re={element:null,cols:0,rows:0,once:!1,fps:30,renderer:"text",allowSelect:!1,restoreState:!1},le=["backgroundColor","color","fontFamily","fontSize","fontWeight","letterSpacing","lineHeight","textAlign"];function Ce(e,o,n={}){return new Promise(function(a){let t=E(E(E({},re),o),e.settings),d={time:0,frame:0,cycle:0},w="currentState";t.restoreState&&(V.restore(w,d),d.cycle++);let l;t.element?t.renderer=="canvas"?t.element.nodeName=="CANVAS"?l=j[t.renderer]:console.warn("This renderer expects a canvas target element."):t.element.nodeName!="CANVAS"?l=j[t.renderer]:console.warn("This renderer expects a text target element."):(l=j[t.renderer]||j.text,t.element=document.createElement(l.preferredElementNodeName),document.body.appendChild(t.element));for(let c of le)t[c]&&(t.element.style[c]=t[c]);let u=[],s={x:0,y:0,pressed:!1,px:0,py:0,ppressed:!1};t.element.addEventListener("pointermove",c=>{let y=t.element.getBoundingClientRect();s.x=c.clientX-y.left,s.y=c.clientY-y.top,u.push("pointerMove")}),t.element.addEventListener("pointerdown",c=>{s.pressed=!0,u.push("pointerDown")}),t.element.addEventListener("pointerup",c=>{s.pressed=!1,u.push("pointerUp")});let p=c=>{let y=t.element.getBoundingClientRect();s.x=c.touches[0].clientX-y.left,s.y=c.touches[0].clientY-y.top,u.push("pointerMove")};t.element.addEventListener("touchmove",p),t.element.addEventListener("touchstart",p),t.element.addEventListener("touchend",p),t.element.style.fontStrech="normal",t.allowSelect||J(t.element),document.fonts.ready.then(c=>{let y=3;(function h(){--y>0?requestAnimationFrame(h):x()})()});let f=new T,C=" ",v=Object.freeze({color:t.color,backgroundColor:t.backgroundColor,fontWeight:t.fontWeight}),r=[],i;function x(){i=B(t.element);let c=X(d,t,i,f);typeof e.boot=="function"&&e.boot(c,r,n),requestAnimationFrame(S)}let g=0,z=0,k=1e3/t.fps,A=d.time,M,W;function S(c){let y=c-g;if(y<k){t.once||requestAnimationFrame(S);return}let h=X(d,t,i,f);f.update(c),g=c-y%k,d.time=c+A,d.frame++,V.store(w,d);let H={x:Math.min(h.cols-1,s.x/i.cellWidth),y:Math.min(h.rows-1,s.y/i.lineHeight),pressed:s.pressed,p:{x:s.px/i.cellWidth,y:s.py/i.lineHeight,pressed:s.ppressed}};if(s.px=s.x,s.py=s.y,s.ppressed=s.pressed,M!=h.cols||W!=h.rows){M=h.cols,W=h.rows,r.length=h.cols*h.rows;for(let b=0;b<r.length;b++)r[b]=F(E({},v),{char:C})}if(typeof e.pre=="function"&&e.pre(h,H,r,n),typeof e.main=="function")for(let b=0;b<h.rows;b++){let G=b*h.cols;for(let O=0;O<h.cols;O++){let N=O+G,_=e.main({x:O,y:b,index:N},h,H,r,n);typeof _=="object"&&_!==null?r[N]=E(E({},r[N]),_):r[N]=F(E({},r[N]),{char:_}),!r[N].char&&r[N].char!==0&&(r[N].char=C)}}for(typeof e.post=="function"&&e.post(h,H,r,n),l.render(h,r,t);u.length>0;){let b=u.shift();b&&typeof e[b]=="function"&&e[b](h,H,r)}t.once||requestAnimationFrame(S),a(h)}})}function X(e,o,n,a){let t=o.element.getBoundingClientRect(),d=o.cols||Math.floor(t.width/n.cellWidth),w=o.rows||Math.floor(t.height/n.lineHeight);return Object.freeze({frame:e.frame,time:e.time,cols:d,rows:w,metrics:n,width:t.width,height:t.height,settings:o,runtime:Object.freeze({cycle:e.cycle,fps:a.fps})})}function J(e){e.style.userSelect="none",e.style.webkitUserSelect="none",e.style.mozUserSelect="none",e.dataset.selectionEnabled="false"}function ie(e){e.style.userSelect="auto",e.style.webkitUserSelect="auto",e.style.mozUserSelect="auto",e.dataset.selectionEnabled="true"}function be(e){let o=!e.dataset.selectionEnabled=="false";o||ie(e);let n=document.createRange();n.selectNode(e);let a=window.getSelection();a.removeAllRanges(),a.addRange(n),document.execCommand("copy"),a.removeAllRanges(),o||J(e)}function B(e){let o=getComputedStyle(e),n=o.getPropertyValue("font-family"),a=parseFloat(o.getPropertyValue("font-size")),t=parseFloat(o.getPropertyValue("line-height")),d;if(e.nodeName=="CANVAS"){let l=e.getContext("2d");l.font=a+"px "+n,d=l.measureText("".padEnd(50,"X")).width/50}else{let l=document.createElement("span");e.appendChild(l),l.innerHTML="".padEnd(50,"X"),d=l.getBoundingClientRect().width/50,e.removeChild(l)}return{aspect:d/t,cellWidth:d,lineHeight:t,fontFamily:n,fontSize:a,_update:function(){let l=B(e);for(var u in l)(typeof l[u]=="number"||typeof l[u]=="string")&&(m[u]=l[u])}}}export{se as RUNNER_VERSION,B as calcMetrics,be as copyContent,Ce as run};
